# Multi-Task NLP Pipeline

Bu proje, AG News veri seti Ã¼zerinde eÄŸitilmiÅŸ bir model ile haber metinlerini analiz eder ve aÅŸaÄŸÄ±daki gÃ¶revleri gerÃ§ekleÅŸtirir:
- **Kategori sÄ±nÄ±flandÄ±rma** (World, Sports, Business, Sci/Tech)
- **Anahtar kelime Ã§Ä±karÄ±mÄ±**
- **Tarih ve lokasyon tespiti**
- **Metin Ã¶zetleme**
- **Zero-Shot sÄ±nÄ±flandÄ±rma** (Opsiyonel olarak farklÄ± kategorilerde deÄŸerlendirme)
- **Ä°ngilizce - Almanca DesteÄŸi**

## ğŸš€ Kurulum AdÄ±mlarÄ±

### 1ï¸âƒ£ Virtual Environment OluÅŸturma

```bash
python3 -m venv venv
source venv/bin/activate  # MacOS/Linux
dot\venv\Scripts\activate  # Windows
```

### 2ï¸âƒ£ Gerekli Paketlerin Kurulumu

```bash
pip install -r requirements.txt
python3 -m spacy download en_core_web_trf
```

### 3ï¸âƒ£ Model Checkpoint'lerini Ä°ndirme

EÄŸer AG News sÄ±nÄ±flandÄ±rma modeli yerel olarak bulunmuyorsa, aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rarak indirilebilir:
```bash
mkdir -p src/models && cd src/models
git clone https://huggingface.co/username/ag_news_classifier
```

---

## ğŸ“Š Veri Seti HazÄ±rlama

### 1ï¸âƒ£ AG News Dataset'ini Ä°ndirme

```bash
from datasets import load_dataset
dataset = load_dataset("ag_news")
```

### 2ï¸âƒ£ Ã–n Ä°ÅŸleme Pipeline'Ä±nÄ± Ã‡alÄ±ÅŸtÄ±rma
```bash
python3 src/preprocessing.py
```

---

## ğŸ¯ Model EÄŸitimi

### 1ï¸âƒ£ EÄŸitim KomutlarÄ±

```bash
python3 src/train.py
```

Hyperparameter ayarlarÄ±nÄ± `config/config.yaml` dosyasÄ±ndan deÄŸiÅŸtirebilirsiniz.

### 2ï¸âƒ£ Multi-GPU DesteÄŸi

Modeli birden fazla GPU'da Ã§alÄ±ÅŸtÄ±rmak iÃ§in:
```bash
CUDA_VISIBLE_DEVICES=0,1 python src/train.py --multi-gpu
```

### 3ï¸âƒ£ Checkpoint Kaydetme/YÃ¼kleme

EÄŸitim sÄ±rasÄ±nda en iyi modeli kaydetmek iÃ§in `config.yaml` dosyasÄ±nda ÅŸu ayarÄ± aÃ§abilirsiniz:
```yaml
load_best_model_at_end: true
save_total_limit: 2
```

EÄŸitime kaldÄ±ÄŸÄ±nÄ±z yerden devam etmek iÃ§in:
```bash
python3 src/train.py --resume_from_checkpoint
```

---

## ğŸ” Inference (Tahmin) Alma

### 1ï¸âƒ£ Tekli Haber Analizi

```bash
python3 src/multi_task_pipeline.py --text "NASA launches a new satellite to explore Mars."
```

### 2ï¸âƒ£ Batch Inference

```bash
python3 src/inference.py
```

### 3ï¸âƒ£ API KullanÄ±mÄ±

```bash
python3 src/multi_task_web_demo.py
```
Yerel sunucu baÅŸlatÄ±ldÄ±ktan sonra aÅŸaÄŸÄ±daki adres Ã¼zerinden eriÅŸebilirsiniz:
```
http://127.0.0.1:7860
```

---

## ğŸ“ˆ Model DeÄŸerlendirme

### 1ï¸âƒ£ Metrik Hesaplama

```bash
python3 src/inference.py
```

Ã‡Ä±ktÄ± Ã¶rneÄŸi:
```
Kategori SÄ±nÄ±flandÄ±rma - Accuracy: 0.86, Precision: 0.87, Recall: 0.86, F1-score: 0.86
Ã–zetleme - ROUGE-L: 0.49, BLEU: 0.49
```

### 2ï¸âƒ£ Test Seti DeÄŸerlendirmesi

AG News test setiyle model deÄŸerlendirmesi yapmak iÃ§in:
```bash
python3 notebooks/model_development.ipynb
```

---

## âš ï¸ Troubleshooting (Hata Giderme)

- **ModÃ¼l BulunamÄ±yor HatasÄ±**: `ModuleNotFoundError: No module named 'utils'`
    ```bash
    export PYTHONPATH=$PYTHONPATH:$(pwd)/src
    ```
- **CUDA Hata Veriyor**: EÄŸer PyTorch CUDA ile Ã§alÄ±ÅŸmÄ±yorsa, aÅŸaÄŸÄ±daki komut ile kontrol edebilirsiniz:
    ```python
    import torch
    print(torch.cuda.is_available())
    ```
- **Web ArayÃ¼zÃ¼ Ã‡alÄ±ÅŸmÄ±yor**: `gradio`'nun kurulu olduÄŸundan emin olun:
    ```bash
    pip install gradio
    ```

---

## âœ… Best Practices ve Ã–neriler

- **BÃ¼yÃ¼k Modeller iÃ§in GPU KullanÄ±mÄ±**: Modelinizi CUDA destekli bir GPU'da Ã§alÄ±ÅŸtÄ±rmak iÃ§in `torch.device("cuda")` kullanÄ±n.
- **Daha Ä°yi Ã–zetleme PerformansÄ± Ä°Ã§in Beam Search KullanÄ±mÄ±**: `num_beams=20, length_penalty=1.5` ayarlarÄ± Ã¶nerilir.
- **Zero-Shot iÃ§in Ã–zel Etiket Seti KullanÄ±mÄ±**: Kendi etiketlerinizi `custom_labels="Finance, Politics, Technology"` ÅŸeklinde girerek Zero-Shot sÄ±nÄ±flandÄ±rma yapabilirsiniz.

---


